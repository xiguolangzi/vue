<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ°´æœè´­ç‰©è½¦</title>
  <style>
    #app {
      /* ç‰ˆå¿ƒå±…ä¸­ */
      margin: 0 auto;
      width: 70%;
      max-width: 1200px;
      padding: 10px;
    }

    .head {
      /* background-color: #6594eb; */
      height: 200px;
    }

    .head-Banner {
      width: 100%;
      height: 90%;
      /* èƒŒæ™¯å›¾ç‰‡ */
      background-image: url('img/fruit.jpg');
      /* ä¸é‡å¤å¹³é“º */
      background-repeat: no-repeat;
      /* å°½å¯èƒ½å……æ»¡å®¹å™¨ */
      background-size: cover;
      /* èƒŒæ™¯å›¾ç‰‡ä½ç½®å±…ä¸­ */
      background-position: center center;
    }

    span {
      font-size: medium;
      font-weight: 600;
      color: blue;
    }

    .body span {
      /* spanè½¬è¡Œå†…å—ï¼Œç„¶åè®¾ç½®å®½åº¦ */
      display: inline-block;
      width: 40px;
    }

    table {
      width: 100%;
    }

    th,
    td {
      border-bottom: 1px solid blue;
      text-align: center;
      margin: 5px;
      padding: 10px;
    }

    th {
      background-color: aquamarine;
    }

    .active {
      background-color: lightblue;
    }
  </style>
</head>

<body>
  <div id="app">
    <!-- å¤´éƒ¨ -->
    <div class="head">
      <div class="head-Banner">
        <!-- <img src="img/fruit.jpg" style="c"> -->
      </div>
      <span>ğŸ </span>
      /
      <span>è´­ç‰©è½¦</span>
    </div>

    <!-- ä¸»ä½“ -->
    <div class="body">
      <table>
        <thead>
          <tr>
            <th v-for="(item,index) in listTH" :key="item.id">{{item.cloumName}}</th>
          </tr>
        </thead>
        <!-- æœ‰æ•°æ® -->
        <tbody v-if="listTD.length > 0">
          <tr v-for="(item,index) in  listTD" :key="item.id" :class="{active:item.checked}">
            <td><input type="checkbox" v-model="item.checked"></td>
            <td><img :src="item.img" :alt="item.name" style="height: 40px;"></td>
            <td>{{item.price}}</td>
            <td>
              <!-- <button @click="item.num--" :disabled="item.num<=0"> - </button> -->
              <button @click="reduce(item.id)" :disabled="item.num<=0"> - </button>
              <span>{{item.num}}</span>
              <!-- <button @click="item.num++"> + </button> -->
              <button @click="add(item.id)"> + </button>
            </td>
            <td>{{item.price * item.num}}</td>
            <td>
              <button @click="del(item.id)"
                style="background-color: red;border-color: red;border-radius: 20%; color: aliceblue;">åˆ é™¤
              </button>
            </td>
          </tr>
        </tbody>
        <!-- æ— æ•°æ® -->
        <tbody v-else>
          <tr>
            <td :colspan="listTH.length">
              <p>æ²¡æœ‰æ•°æ®ï¼</p>
            </td>
          </tr>
        </tbody>
        <tfoot>
          <tr>
            <td><input type="checkbox" v-model="isAll"></td>
            <td></td>
            <td colspan="2">åˆè®¡é‡‘é¢ï¼š<span
                style="color: red; font-size: 20px; display: inline-block; width: 80px;">{{totalMoney}}</span>$ </td>
            <td colspan="2">é€‰ä¸­çš„ç»“ç®—æ•°é‡ï¼š<span style="color: red; font-size: 20px;">{{totalNumber}}</span></td>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>

  <script src="./vue.js"></script>
  <script>
    const defaultArr = [
      { id: 1, checked: true, img: 'img/ç«é¾™æœ.png', name: 'ç«é¾™æœ', price: 5, num: 2 },
      { id: 2, checked: false, img: 'img/è”æ.png', name: 'è”æ', price: 1, num: 16 },
      { id: 3, checked: true, img: 'img/æ¦´è².png', name: 'æ¦´è²', price: 7, num: 111 },
      { id: 4, checked: false, img: 'img/é¸­æ¢¨.png', name: 'é¸­æ¢¨', price: 12, num: 1 },
      { id: 5, checked: true, img: 'img/æ¨±æ¡ƒ.png', name: 'æ¨±æ¡ƒ', price: 3, num: 7 },
    ]
    const app = new Vue({
      el: '#app',
      data: {
        listTH: [
          { id: 1, cloumName: 'é€‰ä¸­' },
          { id: 2, cloumName: 'å›¾ç‰‡' },
          { id: 3, cloumName: 'å•ä»·' },
          { id: 4, cloumName: 'æ•°é‡' },
          { id: 5, cloumName: 'å°è®¡' },
          { id: 6, cloumName: 'æ“ä½œ' },
        ],
        // åˆå§‹åŒ– jsonè½¬åˆ—è¡¨ å¹¶èµ‹äºˆåˆå§‹å€¼ defaultArr
        listTD: JSON.parse(localStorage.getItem('listFrutes')) || defaultArr
        // listTD: defaultArr

      },
      methods: {
        del(id) {
          this.listTD = this.listTD.filter(item => item.id !== id)
        },
        // åŠ å‡æ•°é‡
        add(id) {
          const fruite = this.listTD.find(item => item.id == id)
          fruite.num++
        },
        reduce(id) {
          const fruite = this.listTD.find(item => item.id == id)
          fruite.num--
        }
      },
      computed: {
        totalMoney() {
          let monye = this.listTD.reduce((sum, item) => {
            if (item.checked) {
              return sum + item.price * item.num
            } else {
              return sum
            }
          }, 0)
          return monye.toFixed(2)
        },
        totalNumber() {
          // ç´¯åŠ é€‰ä¸­çš„é¡¹
          let number = this.listTD.reduce((sum, item) => {
            if (item.checked) {
              return sum + item.num
            } else {
              return sum
            }
          }, 0)
          return number
        },
        // å…¨é€‰æ¡†
        isAll: {
          get() {
            // å…¨éƒ¨é€‰ä¸­æ‰æ˜¯true
            let res = this.listTD.every(item => item.checked)
            return res
          },
          set(value) {
            // ä¿®æ”¹æ‰€æœ‰çš„å¸ƒå°”å€¼
            this.listTD.forEach(item => item.checked = value);
          }
        }

      },
      watch: {
        // æŒä¹…åŒ–åˆ°æœ¬åœ°
        listTD: {
          deep: true,
          immediate: true,
          handler(newValue) {
            // å°†å˜åŒ–åçš„ newvalue å­˜å…¥æœ¬åœ°ï¼Œå­˜æœ¬åœ°ä¹‹å‰ä¸è¦å¿˜è®°è½¬json
            localStorage.setItem('listFrutes', JSON.stringify(newValue))

          }
        }

      }
    })
  </script>

</body>

</html>